<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Record Union - WC</title>
    <link href="https://fonts.googleapis.com/css?family=Neucha" rel="stylesheet">
    <!-- Styles -->
    <style>
    body {
        margin: 0;
        font-family: 'Neucha', cursive;
        font-size: 4vh;
        color: black;
    }
    
    p {
        margin: auto 0;
        text-align: center;
    }
    
    #background {
        position: absolute;
        width: 100%;
        height: 100%;
        transition: all 1s;
        background: rgba(106, 163, 94, 0.65);
    }
    
    #background::before {
        content: ' ';
        display: block;
        width: 100%;
        height: 100%;
        background: -moz-radial-gradient(center, ellipse cover, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 50%, rgba(255, 255, 255, 0.7) 72%, rgba(255, 255, 255, 0) 100%);
        background: -webkit-radial-gradient(center, ellipse cover, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 50%, rgba(255, 255, 255, 0.7) 72%, rgba(255, 255, 255, 0) 100%);
        background: radial-gradient(ellipse at center, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 50%, rgba(255, 255, 255, 0.7) 72%, rgba(255, 255, 255, 0) 100%);
        filter: progid: DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#00ffffff', GradientType=1);
    }
    
    #background.occupied {
        transition: all 1s;
        background: rgba(170, 97, 97, 0.65);
    }
    
    #background img {
        width: 100%;
    }
    
    #foreground {
        padding: 10vh 0;
        position: absolute;
        width: 100%;
        display: flex;
        flex-direction: column;
    }
    
    #status {
        display: flex;
        flex-direction: column;
    }
    
    #title {
        font-size: 3vh;
    }
    
    #title::after {
        content: ' ';
        display: block;
        width: 15vh;
        margin: 3vh auto 3vh auto;
        height: 0.2vh;
    }
    
    #last {
        padding-bottom: 7vh;
        color: lightgrey;
    }
    
    #selector {
        width: 4vh;
        height: 4vh;
        margin: auto 0;
        position: relative;
        left: 0.5vh;
        box-shadow: 0.1vw 0.1vw 0.5vw rgba(151, 0, 0, 0.65);
        border-radius: 50%;
        background: #FFFFFF;
    }
    
    #circles {
        margin: auto;
    }
    
    #circle-inner {
        width: 15vh;
        margin: auto;
        display: flex;
        height: 15vh;
        border: 0.2vw solid rgba(0, 0, 0, 0.12);
        border-radius: 50%;
    }
    
    #circle-inner img {
        width: 10vh;
        height: 9vh;
        margin: auto;
        filter: grayscale(100%);
        padding-right: 0.5vh;
    }
    
    #circle-middle {
        width: 25vh;
        margin: auto;
        display: flex;
        height: 25vh;
        border: 0.2vw solid #f7f7f7;
        border-radius: 50%;
    }
    
    #circle-outer {
        width: 35vh;
        height: 35vh;
        border: 0.2vw solid #fbfbfb;
        border-radius: 50%;
        display: flex;
    }
    
    #indicator #superscript {
        transition: all 1s;
        margin: 2vh;
        padding-top: 6vh;
    }
    
    #indicator #occupiedness {
        transition: all 1s;
        margin: auto;
        background: #ce3030;
        width: 10vh;
        display: flex;
        height: 5vh;
        box-shadow: 0.1vw 0.1vw 0.5vw rgba(151, 0, 0, 0.65);
        border-radius: 8vh;
    }
    
    #indicator #selector {
        transition: all 1s;
    }
    
    #indicator #occupiedness {
        background: rgb(91, 205, 113);
        box-shadow: 0.1vw 0.1vw 0.5vw rgba(10, 83, 28, 0.65);
    }
    
    #indicator.occupied #occupiedness {
        background: #ce3030;
        box-shadow: 0.1vw 0.1vw 0.5vw rgba(151, 0, 0, 0.65);
    }
    
    #indicator #superscript::before {
        color: rgb(91, 205, 113);
        content: 'Go for it!';
    }
    
    #indicator.occupied #superscript::before {
        color: #ce3030;
        content: 'Hold it, pal!';
    }
    
    #indicator #occupiedness #selector {
        left: 0.5vh;
    }
    
    #indicator.occupied #occupiedness #selector {
        left: 5.5vh;
    }
    </style>
</head>

<body>
    <div id="background">
    </div>
    <div id="foreground">
        <div id="status">
            <p id="title">Record Union</br>WC</p>
            <p id="last">Last time</br>used</p>
            <div id="circles">
                <div id="circle-outer">
                    <div id="circle-middle">
                        <div id="circle-inner">
                            <img src="./logo.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
            <div id="indicator">
                <p id="superscript" />
                <div id="occupiedness">
                    <div id="selector">
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>
<!-- Scripts -->
<script language="javascript" type="text/javascript">
/**
 * Entry point
 */

! function main() {

    /**
     * Socket bootstrapping
     */

    var uri = "ws://192.168.157.93:5100/notifications";
    var socket = new WebSocket(uri);
    // socket.onopen = function(event) {
    //     console.log("opened connection to " + uri);
    // };
    // socket.onclose = function(event) {
    //     console.log("closed connection from " + uri);
    // };
    socket.onmessage = function(event) {
        var data = JSON.parse(event.data);
        var status = data.Status && 'occupied' || '';
        var last = data.LastActivity.split('Z')[0].split('T').join('</br>');
        document.getElementById('last').innerHTML = last;
        document.getElementById('indicator').className = status;
        document.getElementById('background').className = status;
    };
    // socket.onerror = function(event) {
    //     console.log("error: " + event.data);
    // };


}();
</script>
